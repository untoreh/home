#!/bin/sh
if [ -e ~/.guix-profile/bin/emacsclient ]; then
	ec=~/.guix-profile/bin/emacsclient
else
	ec=emacsclient
fi
[ -z "$UID" ] && UID=$(id -u)
name=${EMACS_SERVER_NAME:-server}
s_tmp=/tmp/emacs$UID/${name}
s_run=/run/user/$UID/emacs/${name}
s_wslg=/mnt/wslg/runtime-dir/emacs/${name}
# unset WAYLAND_DISPLAY; export GDK_BACKEND=x11 CLUTTER_BACKEND=x11
if [ -e $s_run ]; then
    exec $ec -s $s_run -cn $@
elif [ -e $s_tmp ]; then
    exec $ec -s $s_tmp -cn $@
elif [ -e $s_wslg ]; then
    exec $ec -s $s_wslg -cn $@
else
    msg="Couldn't start emacs client because no server was found"
    echo $msg
    [ -v WSLENV ] && notify-send.exe $msg || notify-send $msg
fi
